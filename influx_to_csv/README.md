InfluxDB to CSV
===============

Runs a query on an InfluxDB server and writes the results to a comma separated
value file (CSV).


## To use

This is meant to be used as a python library. To do so:

```python
import sys

# import influx to csv library
influx_to_csv_path = '../influx_to_csv/'
sys.path.append(influx_to_csv_path)
from influx_to_csv import generate_csv

```


## To test

First, ensure that a config file for the InfluxDB instance has been created
(see [../README.md](../README.md))

```
$ ./example_influx_to_csv.py
Running query: SELECT MEAN(value) FROM "rssi" WHERE ("device_class" = 'BLEPacket') AND ("device_id" = 'c098e57000cd' OR "device_id" = 'c098e57000ce') AND (time >= '2017-04-02 04:00:00' AND time < '2017-04-02 05:00:00') GROUP BY "device_id",time(1m) fill(0)
Writing file: raw_data/minutelyRSSI-c098e57000cd.csv
Writing file: raw_data/minutelyRSSI-c098e57000ce.csv
Finished

$ cat raw_data/minutelyRSSI-c098e57000cd.csv
#time,MEAN(value) from rssi
2017-04-02T04:00:00Z,-79.13333333333334
2017-04-02T04:01:00Z,-78.28947368421052
2017-04-02T04:02:00Z,-78.33333333333333
2017-04-02T04:03:00Z,-78.96319018404908
2017-04-02T04:04:00Z,-78.73456790123457
2017-04-02T04:05:00Z,-78.62162162162163
2017-04-02T04:06:00Z,-79.03246753246754
2017-04-02T04:07:00Z,-79.10218978102189
2017-04-02T04:08:00Z,-79.3030303030303
2017-04-02T04:09:00Z,-79.35078534031413
2017-04-02T04:10:00Z,-79.26797385620915
2017-04-02T04:11:00Z,-78.8735632183908
2017-04-02T04:12:00Z,-78.54166666666667
2017-04-02T04:13:00Z,-78.45197740112994
2017-04-02T04:14:00Z,-78.9888888888889
2017-04-02T04:15:00Z,-78.66863905325444
2017-04-02T04:16:00Z,-78.82051282051282
2017-04-02T04:17:00Z,-78.92647058823529
2017-04-02T04:18:00Z,-78.69090909090909
2017-04-02T04:19:00Z,-78.93023255813954
2017-04-02T04:20:00Z,-78.75352112676056
2017-04-02T04:21:00Z,-79.03048780487805
2017-04-02T04:22:00Z,-78.69590643274854
2017-04-02T04:23:00Z,-79.01459854014598
2017-04-02T04:24:00Z,-78.55958549222798
2017-04-02T04:25:00Z,-78.77777777777777
2017-04-02T04:26:00Z,-78.70552147239263
2017-04-02T04:27:00Z,-78.91954022988506
2017-04-02T04:28:00Z,-78.92039800995025
2017-04-02T04:29:00Z,-79.25490196078431
2017-04-02T04:30:00Z,-78.97857142857143
2017-04-02T04:31:00Z,-79.01639344262296
2017-04-02T04:32:00Z,-78.85897435897436
2017-04-02T04:33:00Z,-78.6875
2017-04-02T04:34:00Z,-78.79787234042553
2017-04-02T04:35:00Z,-78.74857142857142
2017-04-02T04:36:00Z,-78.71929824561404
2017-04-02T04:37:00Z,-78.70700636942675
2017-04-02T04:38:00Z,-78.92222222222222
2017-04-02T04:39:00Z,-79
2017-04-02T04:40:00Z,-78.92307692307692
2017-04-02T04:41:00Z,-78.36305732484077
2017-04-02T04:42:00Z,-78.76165803108809
2017-04-02T04:43:00Z,-78.61290322580645
2017-04-02T04:44:00Z,-78.98159509202453
2017-04-02T04:45:00Z,-78.41836734693878
2017-04-02T04:46:00Z,-78.67027027027027
2017-04-02T04:47:00Z,-78.38607594936708
2017-04-02T04:48:00Z,-78.75
2017-04-02T04:49:00Z,-77.96052631578948
2017-04-02T04:50:00Z,-77.43956043956044
2017-04-02T04:51:00Z,-77.44705882352942
2017-04-02T04:52:00Z,-77.56493506493507
2017-04-02T04:53:00Z,-77.25949367088607
2017-04-02T04:54:00Z,-77.47058823529412
2017-04-02T04:55:00Z,-77.48730964467005
2017-04-02T04:56:00Z,-77.50867052023122
2017-04-02T04:57:00Z,-77.36986301369863
2017-04-02T04:58:00Z,-77.6470588235294
2017-04-02T04:59:00Z,-77.53005464480874
```

